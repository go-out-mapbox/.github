const stores = {
  'type': 'FeatureCollection',
  'features': [{
    'type': 'Feature',
    'geometry': {
      'type': 'Point',
      'coordinates': [135.49882344601633, 34.70251955199873]
    },
    'properties': {
      'title': '阪急百貨店梅田店コンコース',
      'address': '日本, 大阪府大阪市北区角田町８−７',
      'date': 'ここにいるのにいないような気持ちになれる落ち着く場所。',
      'tags': 'goout',
      'src': 'qzIy_qtpNh8',
    }
  },
  {
    'type': 'Feature',
    'geometry': {
      'type': 'Point',
      'coordinates': [135.47569470365949, 34.631793416745694]
    },
    'properties': {
      'title': '千本松渡船場',
      'address': '日本, 大阪府大阪市大正区南恩加島 西成区南津守',
      'date': '千本松渡船場は、大阪市の運営する8か所の渡船場のうち、利用者が比較的多い渡船場です。',
      'tags': 'goout',
      'src': 'SNw7eE2K0c0',
    }
  },
  {
    'type': 'Feature',
    'geometry': {
      'type': 'Point',
      'coordinates': [135.46177705603935, 34.62555875027091]
    },
    'properties': {
      'title': '木津川渡船場',
      'address': '日本, 大阪府大阪市住之江区平林北 大正区船町',
      'date': '木津川渡船場の周辺には、巨大な工場・立ち並ぶ鉄塔・広大な道や空き地を通るトラック以外ほとんど何もない',
      'tags': 'goout',
      'src': 'JDQjc70a1T8',
    }
  },
  {
    'type': 'Feature',
    'geometry': {
      'type': 'Point',
      'coordinates': [135.45798171771384, 34.632950453586275]
    },
    'properties': {
      'title': '船町渡船場',
      'address': '日本, 大阪府大阪市大正区船町 大正区鶴町',
      'date': '船町（ふなまち）渡船場は、令和2年度現在、1日平均約163人に利用されています。',
      'tags': 'goout',
      'src': 'Z8Von0j_br8',
    }
  },
  {
    'type': 'Feature',
    'geometry': {
      'type': 'Point',
      'coordinates': [135.49237250787706, 34.6129733697545]
    },
    'properties': {
      'title': '住吉大社',
      'address': '日本, 大阪府大阪市住之江区粉浜西３丁目１',
      'date': '全国の住吉神社の総本社であり、日本を代表する神社の一つ',
      'tags': 'goout',
      'src': 'wbOguTvuV0Q',
    }
  },
  {
    'type': 'Feature',
    'geometry': {
      'type': 'Point',
      'coordinates': [135.4883216199499, 34.611700718642865]
    },
    'properties': {
      'title': '住吉公園 心字池',
      'address': '日本, 大阪府大阪市住之江区浜口東１丁目１',
      'date': '住吉公園の中に、草書体の「心」の形を模した「心字池」という日本庭園があります。',
      'tags': 'goout',
      'src': 'mkioDOspLbs',
    }
  },
  {
    'type': 'Feature',
    'geometry': {
      'type': 'Point',
      'coordinates': [135.48969770207242, 34.61317201110916]
    },
    'properties': {
      'title': '住吉公園 花と水の広場',
      'address': '日本, 大阪府大阪市住之江区浜口東１丁目１',
      'date': '公園の東に位置する沈庄花壇。季節の花が流れに沿って咲いています。',
      'tags': 'goout',
      'src': 'gfwP_viCeZg',
    }
  },
  {
    'type': 'Feature',
    'geometry': {
      'type': 'Point',
      'coordinates': [135.4020868826778, 34.61450991522639]
    },
    'properties': {
      'title': '南港魚つり園護岸',
      'address': '日本, 大阪府大阪市住之江区南港南６丁目９−３',
      'date': '南港南の西の果てに、つり園があった。',
      'tags': 'goout',
      'src': '9DRiQ5CVcjE',
    }
  },
  {
    'type': 'Feature',
    'geometry': {
      'type': 'Point',
      'coordinates': [135.41497842130116, 34.63819701597478]
    },
    'properties': {
      'title': 'コスモタワー',
      'address': '日本, 大阪府大阪市住之江区南港北１丁目１４−１６',
      'date': '南港北（咲洲）にある高さ256.0m、地上55階・地下3階建ての超高層ビル',
      'tags': 'goout',
      'src': '9E8UZio4SJM',
    }
  },
  {
    'type': 'Feature',
    'geometry': {
      'type': 'Point',
      'coordinates': [135.41478295447018, 34.64411832595768]
    },
    'properties': {
      'title': 'シーサイドコスモ',
      'address': '日本, 大阪府大阪市住之江区南港北１丁目３２',
      'date': '大阪南港（咲洲）の玄関口、コスモスクエア駅のすぐ北側にある全長1.4kmにも及ぶ海辺',
      'tags': 'goout',
      'src': 'EoFg1eMWADg',
    }
  },
  {
    'type': 'Feature',
    'geometry': {
      'type': 'Point',
      'coordinates': [135.42081655887517, 34.633723800118446]
    },
    'properties': {
      'title': '南港ポートタウン',
      'address': '日本, 大阪府大阪市住之江区南港中４丁目',
      'date': '大阪南港の人工島「咲洲（さきしま）」の中央部に位置する住宅地、ニュータウン',
      'tags': 'goout',
      'src': '8az_VW2ssbs',
    }
  },
  {
    'type': 'Feature',
    'geometry': {
      'type': 'Point',
      'coordinates': [135.43565751159537, 34.64200256662909]
    },
    'properties': {
      'title': '咲洲コンテナターミナル',
      'address': '日本, 大阪府大阪市住之江区南港東９丁目１',
      'date': '夢洲、咲洲に位置するコンテナ埠頭では、専用コンテナターミナル(C1～4、C8、C9)、メガオペレーターである夢洲コンテナターミナル（株）が一体運営するC10、C11、C12の計9バースが稼働しています。',
      'tags': 'goout',
      'src': 'rlfyH_v-fTk',
    }
  },
  {
    'type': 'Feature',
    'geometry': {
      'type': 'Point',
      'coordinates': [135.50183216544207, 34.61987240976515]
    },
    'properties': {
      'title': '万代池公園',
      'address': '日本, 大阪府大阪市住吉区万代３丁目７',
      'date': '大きな池の周りには遊歩道があり、みなさんがウォーキングしたり、ジョギングしたりしています。　公園もあり、ベンチもいっぱいあるのでみんなの憩いの場という雰囲気です。',
      'tags': 'goout',
      'src': '-7DEl_jxuW8',
    }
  }]
};


// 地図にマーカーを追加
map.on('load', () => {
  map.addSource('places', {
    'type': 'geojson',
    'data': stores
  });
  addMarkers();
});

stores.features.forEach((store, i) => {
  store.properties.id = i;
});

function addMarkers() {
  for (const marker of stores.features) {
    const el = document.createElement('div');
    el.id = `marker-${marker.properties.id}`;
    el.className = marker.properties.tags;
    new mapboxgl.Marker(el, {
      offset: [0, -23]
    })
    .setLngLat(marker.geometry.coordinates)
    .addTo(map);

    el.addEventListener('click', (e) => {
      flyToStore(marker);
      createPopUp(marker);
    });
  }
}

/* Create a Mapbox GL JS `Popup`. */
function createPopUp(currentFeature) {
  dateSection.innerHTML = "";
  yourHere.textContent = currentFeature.properties.title;
  yourAddress.textContent = currentFeature.properties.address;

  const dateTXT = document.createElement('p');
  dateTXT.textContent = currentFeature.properties.date;
  dateSection.appendChild(dateTXT);
}
